> ğŸ’» **[ì‹±ê¸€í†¤ êµ¬í˜„ ì½”ë“œ](https://github.com/Tools26/design-pattern-study/tree/main/05_singleton_pattern/Uijeong)** 

<br>

## ì‹±ê¸€í†¤ íŒ¨í„´ 
- í•˜ë‚˜ì˜ í´ë˜ìŠ¤ì— _**ì˜¤ì§ í•˜ë‚˜ì˜ ì¸ìŠ¤í„´ìŠ¤ë§Œ ê°€ì§€ëŠ” íŒ¨í„´**_
- _**í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ í•˜ë‚˜ì„ì„ ë³´ì¥**_í•˜ëŠ” íŒ¨í„´
- ìƒì„±ìê°€ ì—¬ëŸ¬ë²ˆ í˜¸ì¶œë˜ë„, ì‹¤ì œë¡œ ìƒì„±ë˜ëŠ” ê°ì²´ëŠ” í•˜ë‚˜ì´ë©° ìµœì´ˆë¡œ ìƒì„±ëœ ì´í›„ì— í˜¸ì¶œëœ ìƒì„±ìëŠ” ì´ë¯¸ ìƒì„±í•œ ê°ì²´ë¥¼ ë°˜í™˜
- GoF ë””ìì¸ íŒ¨í„´ ì¤‘ _**ìƒì„± íŒ¨í„´**_ì— í•´ë‹¹

> **ğŸ¤”ì–¸ì œ ì‚¬ìš©í•˜ë‚˜ìš”?** 
1. _**ì£¼ë¡œ ê³µí†µëœ ê°ì²´ë¥¼ ì—¬ëŸ¬ ê³³ì—ì„œ ì°¸ì¡°í•´ì•¼ í•˜ëŠ” ê²½ìš°**_
EX) ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì»¤ë„¥ì…˜í’€, ìŠ¤ë ˆë“œí’€, ìºì‹œ, ë¡œê·¸ ê¸°ë¡ ê°ì²´
EX) ì•ˆë“œë¡œì´ë“œ ì•± : ê° ì•¡í‹°ë¹„í‹° ë“¤ì´ë‚˜, í´ë˜ìŠ¤ë§ˆë‹¤ ì£¼ìš” í´ë˜ìŠ¤ë“¤ì„ í•˜ë‚˜í•˜ë‚˜ ì „ë‹¬í•˜ëŠ”ê²Œ ë²ˆê±°ë¡­ê¸° ë•Œë¬¸ì— ì‹±ê¸€í†¤ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ ì–´ë””ì„œë“  ì ‘ê·¼í•˜ë„ë¡ ì„¤ê³„ <br>
2. _**ì¸ìŠ¤í„´ìŠ¤ê°€ ì ˆëŒ€ì ìœ¼ë¡œ í•œ ê°œë§Œ ì¡´ì¬í•˜ëŠ” ê²ƒì„ ë³´ì¦í•˜ê³  ì‹¶ì€ ê²½ìš°**_
EX) ì»´í“¨í„° ìì²´, í˜„ì¬ì˜ ì‹œìŠ¤í…œ ì„¤ì •, ìœˆë„ìš° ì‹œìŠ¤í…œ), 

<br>

### êµ¬ì¡°
![](https://velog.velcdn.com/images/juijeong8324/post/4ea95e08-3e58-47e7-bb92-e3b1b68cc3fa/image.png)
- **singleton static í•„ë“œ** : Singleton í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ì´ˆê¸°í™”, ì¦‰ Singleton í´ë˜ìŠ¤ë¥¼ ë¡œë“œí•  ë•Œ 1íšŒë§Œ ì‹¤í–‰
- _**ìƒì„±ìë¥¼ privateìœ¼ë¡œ ì„ ì–¸**_ ì¦‰, Singleton í´ë˜ìŠ¤ ì™¸ë¶€ì—ì„œ ìƒì„±ì í˜¸ì¶œì„ ê¸ˆì§€í•˜ê¸° ìœ„í•¨.
- **getInstance()** : Singleton í´ë˜ìŠ¤ì˜ _**ìœ ì¼í•œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì–»ëŠ” ë©”ì†Œë“œ**_, ì¦‰ í´ë˜ìŠ¤ ì™¸ë¶€ì—ì„œ new Singleton()ì„ í•˜ë©´ ì»´íŒŒì¼ ì—ëŸ¬ ë°œìƒ(ìƒì„±ìê°€ privateì´ê¸° ë•Œë¬¸) 
- ì½”í‹€ë¦°ì—ì„œëŠ” ì‹±ê¸€í†¤ íŒ¨í„´ì„ ë³´ì¥í•´ì£¼ëŠ” object í‚¤ì›Œë“œê°€ ì¡´ì¬í•œë‹¤.

<br>

### ì¥ì  
- **í•˜ë‚˜ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•  ë•Œ ë“œëŠ” ë¹„ìš©ì´ ì¤„ì–´ë“¬**
: ê°ì²´ë¥¼ ìƒì„±í•  ë•Œë§ˆë‹¤ ë©”ëª¨ë¦¬ ì˜ì—­ì„ í• ë‹¹ ë°›ëŠ”ë° í•œ ë²ˆì˜ newë¥¼ í†µí•´ ê°ì²´ë¥¼ ìƒì„±í•˜ì—¬ ë©”ëª¨ë¦¬ ë‚­ë¹„ ë°©ì§€
- **ìœ ì¼í•˜ê²Œ ì¡´ì¬í•˜ëŠ” ì¸ìŠ¤í„´ìŠ¤ë¡œì˜ ì ‘ê·¼ì„ í†µì œ**
: ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìº¡ìŠí™”í•˜ë¯€ë¡œ, ì‚¬ìš©ìì˜ ì ‘ê·¼ì„ ì œì–´
- **ì „ì—­ë³€ìˆ˜ë³´ë‹¤ ì¢‹ìŒ**
: ì‹±ê¸€í†¤ìœ¼ë¡œ êµ¬í˜„í•œ ì¸ìŠ¤í„´ìŠ¤ëŠ” 'ì „ì—­'ì´ë¯€ë¡œ, ë‹¤ë¥¸ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë“¤ì´ ë°ì´í„°ë¥¼ ê³µìœ í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥


<br>

### ë‹¨ì  
- **ì˜ì¡´ì„±ì´ ë„ˆë¬´ ë†’ìœ¼ë©° ëª¨ë“ˆ ê°„ì˜ ê²°í•©ì„ ê°•í•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆìŒ**
: ë§Œì•½ ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤ê°€ í˜¼ì ë„ˆë¬´ ë§ì€ ì¼ì„ í•˜ê±°ë‚˜, ë§ì€ ë°ì´í„°ë¥¼ ê³µìœ ì‹œí‚¤ë©´ ë‹¤ë¥¸ í´ë˜ìŠ¤ë“¤ ê°„ì˜ ê²°í•©ë„ê°€ ë†’ì•„ì§€ê²Œ ë˜ëŠ”ë°, ì´ë•Œ ê°œë°©-íì‡„ ì›ì¹™ì´ ìœ„ë°°

> **ì˜ì¡´ì„±(=ì¢…ì†ì„±)** 
Aê°€ Bì— ì˜ì¡´ì„±ì´ ìˆë‹¤ëŠ” ê²ƒì€ Bì˜ ë³€ê²½ ì‚¬í•­ì— ëŒ€í•´ A ë˜í•œ ë³€í•´ì•¼ ëœë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸

> **ì˜ì¡´ì„± ì£¼ì…(DI, Dependency Injection)**
<img src="https://thebook.io/img/080326/023.jpg" width=500 />
- _**ì˜ì¡´ì„± ì£¼ì…ì(dependency injector)**_ê°€ 'ì§ì ‘' ë‹¤ë¥¸ í•˜ìœ„ ëª¨ë“ˆì— ëŒ€í•œ ì˜ì¡´ì„±ì„ ì£¼ê³  ë©”ì¸ ëª¨ë“ˆì´ 'ê°„ì ‘'ì ìœ¼ë¡œ ì˜ì¡´ì„±ì„ ì£¼ì… 
- ë©”ì¸ ëª¨ë“ˆì€ í•˜ìœ„ ëª¨ë“ˆì— ëŒ€í•œ ì˜ì¡´ì„±ì´ ë–¨ì–´ì§ â†’ ë””ì»¤í”Œë§ì´ ëœë‹¤. 
- ì›ì¹™ 
â€¢ ìƒìœ„ ëª¨ë“ˆì€ í•˜ìœ„ ëª¨ë“ˆì—ì„œ ì–´ë– í•œ ê²ƒë„ ê°€ì ¸ì˜¤ì§€ ì•Šì•„ì•¼ í•¨
â€¢ ë‘˜ ë‹¤ ì¶”ìƒí™”ì— ì˜ì¡´í•´ì•¼ í•˜ë©°, ì´ë•Œ ì¶”ìƒí™”ëŠ” ì„¸ë¶€ ì‚¬í•­ì— ì˜ì¡´í•˜ì§€ ë§ì•„ì•¼ í•¨


- **TDD(Test Driven Development)ì—ì„œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸**ë¥¼ í•  ë•Œ í˜ë“¤ë‹¤ 
: ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ í•  ë•Œ í…ŒìŠ¤íŠ¸ëŠ” ì„œë¡œ ë…ë¦½ì ì´ì–´ì•¼ í•¨. ê·¸ëŸ¬ë‚˜ ì‹±ê¸€í†¤ íŒ¨í„´ì€ ë¯¸ë¦¬ ìƒì„±ëœ í•˜ë‚˜ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ êµ¬í˜„í•˜ëŠ” íŒ¨í„´ì´ë¯€ë¡œ _**ê° í…ŒìŠ¤íŠ¸ë§ˆë‹¤ 'ë…ë¦½ì ì¸' ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ê¸° ì–´ë ¤ì›€**_ 

- ë©€í‹° ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œ ë™ê¸°í™” ì²˜ë¦¬ë¥¼ í•˜ì§€ ì•Šì•˜ì„ ë•Œ, ì¸ìŠ¤í„´ìŠ¤ê°€ 2ê°œê°€ ìƒì„±ë˜ëŠ” ë¬¸ì œ -> [í•´ê²°ë²•](https://gyoogle.dev/blog/design-pattern/Singleton%20Pattern.html)

<br>
<br>

## EXAMPLE
### Java
```java
class Singleton {
    private static Singleton instance;
    private String name;
    private int count = 0;

    private Singleton() {
        count++; // ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë˜ë©´ í•´ë‹¹ countê°€ ì¦ê°€í•  ê²ƒì„. 
        name = "This is the only reference : " + count;
    }

    public static Singleton getInstance() {
        if(instance == null){
            instance = new Singleton(); // ì¸ìŠ¤í„´ìŠ¤ê°€ ì¡´ì¬í•˜ì§€ ì•Šì„ ë•Œë§Œ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± 
        }
        return instance; // ê¸°ì¡´ì˜ ì¸ìŠ¤í„´ìŠ¤ return 
    }
    public String getName() {
        return name;
    }
}

public class Main {
    public static void main(String[] args) {
        Singleton singleton_reference1 = Singleton.getInstance();
        System.out.println("First Instance Name : "+singleton_reference1.getName());

        Singleton singleton_reference2 = Singleton.getInstance();
        System.out.println("Second Instance Name : "+singleton_reference2.getName());
    }
}
```

<br>

### JavaScript
- Javascriptì—ì„œ **1. ë¦¬í„°ëŸ´ ```{}``` 2. ```new Object```**ë¡œ ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ì´ ìì²´ë§Œìœ¼ë¡œ ì‹±ê¸€í†¤ íŒ¨í„´ì„ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤. 
> ğŸ¤” **[Why?](https://hjban-dev.github.io/2019-12-13-class_literal)** 
**í´ë˜ìŠ¤ ì •ì˜ì™€ ë™ì‹œì— ì¸ìŠ¤í„´ìŠ¤ê°€ ìë™ìœ¼ë¡œ ìƒì„±**ë˜ê¸° ë•Œë¬¸ 
[ìë°”ìŠ¤í¬ë¦½íŠ¸ì— ëŒ€í•´ì„œ1](https://developer.mozilla.org/ko/docs/Learn/JavaScript/Objects/Object_prototypes#create_%EB%8B%A4%EC%8B%9C%EB%B3%B4%EA%B8%B0)
[{} vs new Object](https://timotimo.tistory.com/27)

```js
const obj = {
    a: 27
}

console.log(obj === obj)
// true
// ê°ì²´ ì •ì˜ì™€ ë™ì‹œì— ì¸ìŠ¤í„´ìŠ¤ë¡œì„œ ì‚¬ìš©, ë” ì´ìƒ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¶”ê°€í•  ìˆ˜ ì—†ìŒ
```

<br>

- Singleton.instanceë¼ëŠ” í•˜ë‚˜ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê°€ì§€ëŠ” Singleton í´ë˜ìŠ¤ êµ¬í˜„ 
```js
class Singleton {
    constructor() { // ìƒì„±ì 
        if (!Singleton.instance) { // ì¸ìŠ¤í„´ìŠ¤ê°€ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ 
            Singleton.instance = this // ì´ ê°ì²´ë¥¼ ì¸ìŠ¤í„´ìŠ¤ë¡œ ì§€ì • 
        }
        return Singleton.instance // ì¡´ì¬í•˜ë©´ ë°”ë¡œ ì¸ìŠ¤í„´ìŠ¤ return
    }
    getInstance() {
        return this 
    }
}
const a = new Singleton()
const b = new Singleton() 
console.log(a === b) // true 
``` 

<br>

### ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ëª¨ë“ˆ
ì‹±ê¸€í†¤ íŒ¨í„´ì€ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ëª¨ë“ˆì— ë§ì´ ì“°ì¸ë‹¤. ì´ë¥¼ í†µí•´ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì— ê´€í•œ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ë¹„ìš©ì„ ì•„ë‚„ ìˆ˜ ìˆë‹¤.

```js
// DB ì—°ê²°ì„ í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— ë¹„ìš©ì´ ë” ë†’ì€ ì‘ì—… 
const URL = 'mongodb://localhost:27017/kundolapp' 
const createConnection = url => ({"url" : url})  // DBë¥¼ ì—°ê²°í•´ì£¼ëŠ” í•¨ìˆ˜, url ì†ì„±ì´ ë‹´ê¸´ ê°ì²´ë¥¼ ì „ë‹¬í•œë‹¤. 

class DB {
    constructor(url) {
        if (!DB.instance) { 
            DB.instance = createConnection(url)
        }
        return DB.instance
    }
    connect() {
        return this.instance
    }
}

const a = new DB(URL)
const b = new DB(URL) 
console.log(a === b) // true
console.log(a.url) // mongodb://localhost:27017/kundolapp
```

<br>

### Mongoose
- ì‹¤ì œë¡œ Node.jsì—ì„œ MongoDB ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì—°ê²°í•  ë•Œ ì“°ëŠ” monogoose ëª¨ë“ˆì—ì„œ ì‹±ê¸€í†¤ íŒ¨í„´ì„ ë³¼ ìˆ˜ ìˆë‹¤.
- ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì—°ê²°í•  ë•Œ ì“°ëŠ” connect()ë¼ëŠ” í•¨ìˆ˜ëŠ” ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°˜í™˜ 

```js
// connect() í•¨ìˆ˜ êµ¬í˜„ ì½”ë“œ 
Mongoose.prototype.connect = function(uri, options, callback){
    const _mongoose = this instanceof Mongoose ? this : mongoose; // ì¸ìŠ¤í„´ìŠ¤ ì¡´ì¬í•˜ë©´ ì´ê±° ì—†ìœ¼ë©´ mongoose ìƒì„± 
    const conn = _mongoose.connection; // ì¸ìŠ¤í„´ìŠ¤ì˜ connection ì†ì„±

    return _mongoose._promiseOrCallback(callback, cb =>{
        conn.openUri(uri, options, err => {
            if(err != null){ // ì—ëŸ¬ ë°œìƒì‹œ 
               return cb(err);
            }
            return cb(null, _mongoose); // ì—ëŸ¬ ë°œìƒ ì•ˆ í•œ ê²½ìš° 
        });
    });
};
```
<br>

### MySQL
- Node.jsì—ì„œ MySQL ë°ì´í„° ë² ì´ìŠ¤ë¥¼ ì—°ê²°í•  ë•Œë„ ì‹±ê¸€í†¤ íŒ¨í„´ì´ ì“°ì¸ë‹¤. 
- ë©”ì¸ ëª¨ë“ˆì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì— ê´€í•œ ì¸ìŠ¤í„´ìŠ¤ ì •ì˜ í›„ ë‹¤ë¥¸ ëª¨ë“ˆì¸ A ë˜ëŠ” Bì—ì„œ í•´ë‹¹ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì¿¼ë¦¬ë¥¼ ë³´ë‚´ëŠ” í˜•ì‹ 
```js
// ë©”ì¸ ëª¨ë“ˆ - DB ì—°ê²°ì— ê´€í•œ ì¸ìŠ¤í„´ìŠ¤ ì •ì˜, ê°ì²´ ì •ì˜ì™€ ë™ì‹œì— ì¸ìŠ¤í„´ìŠ¤ ìƒì„± 
const mysql = require('mysql');
const pool = mysql.createPool({
    connectionLimit: 10,
    host: 'example.org',
    user: 'kundol',
    password: 'secret',
    database : 'ìŠ¹ì² ì´ë””ë¹„'
});
pool.connect();

// ëª¨ë“ˆ A 
pool.query(query, function (error, results, fields){
    if(error) throw error;
    console.log('The solution is: ', results[0].solution);
});

// ëª¨ë“ˆ B
pool.query(query, function (error, results, fields){
    if(error) throw error;
    console.log('The solution is: ', results[0].solution);
});
```

<br>
<br>



